<div class="container-fluid">
  <div class="row">
    <!-- Header Section -->
    <div class="col-12">
      <div class="card border-0 shadow-lg rounded-4 mb-4">
        <div class="card-header bg-gradient-primary py-4">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h4 class="mb-0 fw-bold text-white">
                <i class="bi bi-graph-up me-2"></i>
                Analytics Dashboard
              </h4>
              <p class="mb-0 text-white-50">Real-time insights and metrics</p>
            </div>
            <div class="col-md-4 text-end">
              <div class="d-flex align-items-center justify-content-end gap-2">
                <select
                  class="form-select form-select-sm"
                  [(ngModel)]="selectedDays"
                  (change)="onDaysChange()"
                  style="width: auto;">
                  <option value="7">Last 7 days</option>
                  <option value="30">Last 30 days</option>
                  <option value="90">Last 90 days</option>
                </select>
                <button class="btn btn-sm btn-light" (click)="refreshData()" [disabled]="loading">
                  <i class="bi bi-arrow-repeat"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Summary Cards -->
    <div class="col-12 mb-4">
      <div class="row">
        <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
          <div class="card stat-card border-0 h-100">
            <div class="card-body text-center">
              <i class="bi bi-people fs-1 text-primary mb-3"></i>
              <h3 class="fw-bold mb-1">{{ analytics.summary.totalUsers }}</h3>
              <p class="text-muted mb-0">Total Users</p>
            </div>
          </div>
        </div>
        <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
          <div class="card stat-card border-0 h-100">
            <div class="card-body text-center">
              <i class="bi bi-camera-video fs-1 text-success mb-3"></i>
              <h3 class="fw-bold mb-1">{{ analytics.summary.totalWebinars }}</h3>
              <p class="text-muted mb-0">Total Webinars</p>
            </div>
          </div>
        </div>
        <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
          <div class="card stat-card border-0 h-100">
            <div class="card-body text-center">
              <i class="bi bi-calendar-event fs-1 text-info mb-3"></i>
              <h3 class="fw-bold mb-1">{{ analytics.summary.totalEvents }}</h3>
              <p class="text-muted mb-0">Total Events</p>
            </div>
          </div>
        </div>
        <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
          <div class="card stat-card border-0 h-100">
            <div class="card-body text-center">
              <i class="bi bi-person-check fs-1 text-warning mb-3"></i>
              <h3 class="fw-bold mb-1">{{ analytics.summary.totalRegistrations }}</h3>
              <p class="text-muted mb-0">Registrations</p>
            </div>
          </div>
        </div>
        <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
          <div class="card stat-card border-0 h-100">
            <div class="card-body text-center">
              <i class="bi bi-broadcast fs-1 text-danger mb-3"></i>
              <h3 class="fw-bold mb-1">{{ analytics.summary.activeWebinars }}</h3>
              <p class="text-muted mb-0">Live Now</p>
            </div>
          </div>
        </div>
        <div class="col-lg-2 col-md-4 col-sm-6 mb-3">
          <div class="card stat-card border-0 h-100">
            <div class="card-body text-center">
              <i class="bi bi-calendar-plus fs-1 text-purple mb-3"></i>
              <h3 class="fw-bold mb-1">{{ analytics.summary.upcomingEvents }}</h3>
              <p class="text-muted mb-0">Upcoming</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="col-lg-8 mb-4">
      <div class="card border-0 shadow-lg rounded-4">
        <div class="card-header bg-light border-0">
          <div class="row align-items-center">
            <div class="col-md-8">
              <h5 class="mb-0 fw-bold">{{ getChartTitle() }} Trends</h5>
            </div>
            <div class="col-md-4 text-end">
              <select
                class="form-select form-select-sm"
                [(ngModel)]="selectedChartType"
                (change)="onChartTypeChange()"
                style="width: auto;">
                <option value="users">Users</option>
                <option value="webinars">Webinars</option>
                <option value="events">Events</option>
              </select>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div *ngIf="chartLoading" class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
          <div *ngIf="!chartLoading" class="chart-container">
            <div class="row">
              <div class="col-12">
                <p class="text-muted mb-3">
                  Total {{ selectedChartType }}: 
                  <strong>{{ getCurrentChartData().total }}</strong>
                </p>
              </div>
              <div class="col-12">
                <div class="chart-placeholder text-center py-5 bg-light rounded">
                  <i class="bi bi-bar-chart fs-1 text-muted mb-3"></i>
                  <p class="text-muted">Chart data: {{ getCurrentChartData().labels.length }} data points</p>
                  <small class="text-muted">Chart integration can be added with Chart.js or similar library</small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Recent Activities -->
    <div class="col-lg-4 mb-4">
      <div class="card border-0 shadow-lg rounded-4">
        <div class="card-header bg-light border-0">
          <h5 class="mb-0 fw-bold">Recent Activities</h5>
        </div>
        <div class="card-body p-0" style="max-height: 400px; overflow-y: auto;">
          <div *ngIf="activitiesLoading" class="text-center py-4">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
          <div *ngIf="!activitiesLoading && recentActivities.length > 0">
            <div *ngFor="let activity of recentActivities" class="activity-item p-3 border-bottom">
              <div class="d-flex align-items-start">
                <div class="activity-icon me-3">
                  <i [class]="activity.icon" class="text-primary fs-5"></i>
                </div>
                <div class="flex-grow-1">
                  <h6 class="mb-1">{{ activity.action }}</h6>
                  <p class="mb-1 text-muted small">{{ activity.details }}</p>
                  <small class="text-muted">{{ formatDate(activity.timestamp) }}</small>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="!activitiesLoading && recentActivities.length === 0" class="text-center py-4">
            <i class="bi bi-activity fs-3 text-muted mb-2"></i>
            <p class="text-muted mb-0">No recent activities</p>
          </div>
        </div>
      </div>
    </div>

    <!-- User Metrics -->
    <div class="col-lg-6 mb-4">
      <div class="card border-0 shadow-lg rounded-4">
        <div class="card-header bg-light border-0">
          <h5 class="mb-0 fw-bold">User Metrics</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-6 mb-3">
              <div class="metric-item">
                <h4 class="text-primary fw-bold">{{ analytics.userMetrics.newToday }}</h4>
                <p class="text-muted mb-0">New Today</p>
              </div>
            </div>
            <div class="col-6 mb-3">
              <div class="metric-item">
                <h4 class="text-success fw-bold">{{ analytics.userMetrics.newThisMonth }}</h4>
                <p class="text-muted mb-0">This Month</p>
              </div>
            </div>
            <div class="col-12">
              <div class="progress-item mb-3">
                <div class="d-flex justify-content-between mb-1">
                  <span class="text-muted">Verified Users</span>
                  <span class="text-muted">{{ getProgressPercentage(analytics.userMetrics.verified, analytics.userMetrics.total) }}%</span>
                </div>
                <div class="progress">
                  <div class="progress-bar bg-success" 
                       [style.width.%]="getProgressPercentage(analytics.userMetrics.verified, analytics.userMetrics.total)">
                  </div>
                </div>
                <small class="text-muted">{{ analytics.userMetrics.verified }} of {{ analytics.userMetrics.total }} users</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Webinar Metrics -->
    <div class="col-lg-6 mb-4">
      <div class="card border-0 shadow-lg rounded-4">
        <div class="card-header bg-light border-0">
          <h5 class="mb-0 fw-bold">Webinar Metrics</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-4 mb-3">
              <div class="metric-item text-center">
                <h5 class="text-warning fw-bold">{{ analytics.webinarMetrics.scheduled }}</h5>
                <small class="text-muted">Scheduled</small>
              </div>
            </div>
            <div class="col-4 mb-3">
              <div class="metric-item text-center">
                <h5 class="text-danger fw-bold">{{ analytics.webinarMetrics.live }}</h5>
                <small class="text-muted">Live</small>
              </div>
            </div>
            <div class="col-4 mb-3">
              <div class="metric-item text-center">
                <h5 class="text-info fw-bold">{{ analytics.webinarMetrics.completed }}</h5>
                <small class="text-muted">Completed</small>
              </div>
            </div>
            <div class="col-12">
              <div class="d-flex justify-content-between">
                <div class="text-center">
                  <h6 class="text-primary">{{ analytics.webinarMetrics.free }}</h6>
                  <small class="text-muted">Free</small>
                </div>
                <div class="text-center">
                  <h6 class="text-success">{{ analytics.webinarMetrics.paid }}</h6>
                  <small class="text-muted">Paid</small>
                </div>
                <div class="text-center">
                  <h6 class="text-warning">{{ analytics.webinarMetrics.totalRegistrations }}</h6>
                  <small class="text-muted">Total Registrations</small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Event Metrics -->
    <div class="col-lg-6 mb-4">
      <div class="card border-0 shadow-lg rounded-4">
        <div class="card-header bg-light border-0">
          <h5 class="mb-0 fw-bold">Event Metrics</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-6 mb-3">
              <div class="metric-item">
                <h5 class="text-success fw-bold">{{ analytics.eventMetrics.upcoming }}</h5>
                <p class="text-muted mb-0">Upcoming</p>
              </div>
            </div>
            <div class="col-6 mb-3">
              <div class="metric-item">
                <h5 class="text-secondary fw-bold">{{ analytics.eventMetrics.past }}</h5>
                <p class="text-muted mb-0">Past</p>
              </div>
            </div>
            <div class="col-12">
              <div class="row">
                <div class="col-6">
                  <small class="text-muted">By Type:</small>
                  <div class="d-flex justify-content-between">
                    <span>Events: {{ analytics.eventMetrics.byType.event }}</span>
                    <span>Meetings: {{ analytics.eventMetrics.byType.meeting }}</span>
                  </div>
                </div>
                <div class="col-6">
                  <small class="text-muted">By Mode:</small>
                  <div class="d-flex justify-content-between">
                    <span>Online: {{ analytics.eventMetrics.byMode.online }}</span>
                    <span>Offline: {{ analytics.eventMetrics.byMode.offline }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Feedback Metrics -->
    <div class="col-lg-6 mb-4">
      <div class="card border-0 shadow-lg rounded-4">
        <div class="card-header bg-light border-0">
          <h5 class="mb-0 fw-bold">Feedback Metrics</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-6">
              <h6 class="text-muted mb-2">Complaints</h6>
              <div class="mb-2">
                <span class="badge bg-warning me-2">{{ analytics.feedbackMetrics.complaints.pending }}</span>
                <small>Pending</small>
              </div>
              <div class="mb-2">
                <span class="badge bg-success me-2">{{ analytics.feedbackMetrics.complaints.resolved }}</span>
                <small>Resolved</small>
              </div>
              <div>
                <span class="badge bg-secondary me-2">{{ analytics.feedbackMetrics.complaints.total }}</span>
                <small>Total</small>
              </div>
            </div>
            <div class="col-6">
              <h6 class="text-muted mb-2">Suggestions</h6>
              <div class="mb-2">
                <span class="badge bg-warning me-2">{{ analytics.feedbackMetrics.suggestions.pending }}</span>
                <small>Pending</small>
              </div>
              <div class="mb-2">
                <span class="badge bg-success me-2">{{ analytics.feedbackMetrics.suggestions.implemented }}</span>
                <small>Implemented</small>
              </div>
              <div>
                <span class="badge bg-secondary me-2">{{ analytics.feedbackMetrics.suggestions.total }}</span>
                <small>Total</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>